% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/CSSG.toolkit.R
\name{heterogeneity_select_specificity}
\alias{heterogeneity_select_specificity}
\title{Select Cluster-Specific Marker Genes Based on Heterogeneity}
\usage{
heterogeneity_select_specificity(
  sc_project,
  type = NaN,
  heterogeneity_factor = 80,
  p_val = 0.05,
  max_genes = 1000,
  select_stat = "p_val",
  min_occ = 5,
  mito_content = FALSE
)
}
\arguments{
\item{sc_project}{A single-cell project object containing normalized gene expression data.}

\item{type}{A character string specifying the cluster type. Must be one of: 
'subtypes', 'subclasses', 'cluster', or 'primary'.}

\item{heterogeneity_factor}{A numeric value defining the maximum percentage of cells in a 
cluster expressing a gene for it to be considered heterogeneous. Default is 80.}

\item{p_val}{A numeric value specifying the p-value threshold for gene selection. 
Default is 0.05.}

\item{max_genes}{A numeric value defining the maximum number of genes to retain per cluster. 
Default is 1000.}

\item{select_stat}{A character string specifying the ranking statistic for gene selection. 
Options: 'p_val' (default), 'avg_logFC', or 'avg_log2FC'.}

\item{min_occ}{A numeric value specifying the minimum percentage occurrence of a gene in a cluster. 
Default is 5.}

\item{mito_content}{A logical value indicating whether to include mitochondrial genes in the selection. 
Default is FALSE.}
}
\value{
An updated `sc_project` object with identified heterogeneity marker genes stored 
  in the `metadata$heterogeneity_markers` slot.
}
\description{
Identifies cluster-specific marker genes by considering gene expression heterogeneity, 
statistical significance, and occurrence thresholds.
}
\details{
The function performs the following steps:
  - Validates the `type` parameter.
  - Extracts the relevant cluster labels.
  - Filters marker genes based on p-value and removes mitochondrial genes if specified.
  - Iterates over each cluster to:
    - Identify genes expressed in a heterogeneous manner.
    - Rank genes based on `select_stat` (e.g., log fold change or p-value).
    - Retain a specified number of top marker genes.
  - Removes genes appearing in multiple clusters beyond a threshold.
  - Stores the final marker gene lists in `sc_project@metadata$heterogeneity_markers`.
}
\examples{
updated_project <- heterogeneity_select_specificity(sc_project, type = "subtypes", 
  heterogeneity_factor = 75, p_val = 0.01, max_genes = 500, select_stat = "avg_logFC")

}
